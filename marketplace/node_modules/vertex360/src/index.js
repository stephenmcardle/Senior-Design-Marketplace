var superagent = require('superagent')
var Promise = require('bluebird')

// Vertex imports
var Vertex = require('./vertex/Vertex')
var Router = require('./vertex/Router')
var local = require('./vertex/local')

var Microservice = function(credentials){
	const BASE_URL = 'https://api.turbo360.co'
	const TURBO_URL = 'https://www.turbo360.co'

	var config = {
		site_id: credentials['site_id'],
		turbo_url: TURBO_URL, // for fetching turbo dashboard resources (site, profile, etc)
		base_url: BASE_URL
	}

	var vertexApp = function(){
		if (process.env.TURBO_ENV == 'prod'){ // this is null in production
			var app = new Vertex()
			return app
		}

		var app = local.app()
		return app
	}

	var router = function(){
		if (process.env.TURBO_ENV == 'prod'){ // this is null in production
			var router = new Router()
			return router
		}

		// console.log('DEV ROUTER!')
		var router = local.router()
		return router
	}

	var client = {
		app: vertexApp,
		router: router
	}

	return client
}

module.exports = Microservice
